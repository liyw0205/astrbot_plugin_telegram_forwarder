{
    "napcat_api_url": {
        "description": "NapCat API 地址",
        "type": "string",
        "hint": "NapCat 的 HTTP API 地址。通常保持默认 localhost，使用框架内部接口发送",
        "default": "localhost"
    },
    "target_qq_group": {
        "description": "QQ 目标群号",
        "type": "list",
        "item_type": "int",
        "hint": "转发到 QQ 群列表",
        "default": []
    },
    "target_channel": {
        "description": "TG 目标频道 ID",
        "type": "string",
        "hint": "接收消息的频道，例如 @my_channel_name 或 -100xxxxxxx",
        "default": ""
    },
    "phone": {
        "description": "手机号",
        "type": "string",
        "default": "",
        "hint": "登录用的手机号（国际格式，如 +86138...），首次运行时需要"
    },
    "api_id": {
        "description": "App API ID",
        "type": "int",
        "default": 0,
        "hint": "从 my.telegram.org 获取，例如 123456"
    },
    "api_hash": {
        "description": "App API Hash",
        "type": "string",
        "default": "",
        "hint": "从 my.telegram.org 获取"
    },
    "telegram_session": {
        "type": "file",
        "description": "Telegram Session 文件",
        "default": [],
        "file_types": [
            "session"
        ],
        "hint": "上传 .session 文件以直接登录，避免验证码或人机验证问题，你可以使用本地脚本生成此文件后上传"
    },
    "proxy": {
        "description": "代理地址",
        "type": "string",
        "hint": "部分网络环境访问 Telegram 需要代理，例如 http://127.0.0.1:7890",
        "default": ""
    },
    "source_channels": {
        "description": "源频道配置列表",
        "type": "template_list",
        "templates": {
            "default": {
                "name": "频道配置",
                "hint": "配置 Telegram 频道的抓取参数",
                "items": {
                    "channel_username": {
                        "type": "string",
                        "description": "频道用户名 (不带@)"
                    },
                    "target_qq_groups": {
                        "description": "该频道专属的 QQ 目标群号",
                        "type": "list",
                        "item_type": "int",
                        "default": [],
                        "hint": "填写则覆盖全局 QQ 目标群号 留空使用全局配置"
                    },
                    "start_time": {
                        "type": "string",
                        "description": "起始日期 (YYYY-MM-DD)",
                        "hint": "留空则仅转发新消息，填具体日期则补发旧消息"
                    },
                    "check_interval": {
                        "type": "int",
                        "description": "检测间隔 (秒)",
                        "default": 0,
                        "hint": "该频道专用的检测频率，为 0 时使用全局配置"
                    },
                    "msg_limit": {
                        "type": "int",
                        "description": "单次抓取上限",
                        "default": 10,
                        "hint": "每次检测最多处理几条消息，建议设为 5~20"
                    },
                    "priority": {
                        "type": "int",
                        "description": "优先级",
                        "default": 0,
                        "hint": "数值越大优先级越高，未设置或为 0 时优先级最低，设置值需 >= 1"
                    },
                    "exclude_text_on_media": {
                        "description": "媒体消息仅发送媒体",
                        "type": "string",
                        "options": ["继承全局", "开启", "关闭"],
                        "default": "继承全局",
                        "hint": "开启时，若消息包含媒体则不发送文本；选择‘继承全局’则使用全局配置"
                    },
                    "forward_types": {
                        "description": "转发消息类型",
                        "type": "list",
                        "hint": "选择需要搬运的消息类型，全不选表示不搬运任何消息",
                        "options": ["文字", "图片", "视频", "音频", "文件"],
                        "default": ["文字", "图片", "视频", "音频", "文件"]
                    },
                    "max_file_size": {
                        "description": "文件大小限制 (MB)",
                        "type": "float",
                        "default": 0,
                        "hint": "除图片外的媒体大小限制，0 表示不限制"
                    },
                    "ignore_global_filters": {
                        "description": "忽略全局文本过滤",
                        "type": "bool",
                        "default": false,
                        "hint": "开启后，该频道将**忽略全局**的 filter_keywords 和 filter_regex（但仍执行本频道自己的过滤规则）。常用于白名单式频道或重要通知频道。"
                    },
                    "filter_keywords": {
                        "type": "list",
                        "item_type": "string",
                        "description": "过滤关键词",
                        "default": [],
                        "hint": "包含这些关键词的消息将被丢弃"
                    },
                    "filter_regex": {
                        "type": "string",
                        "description": "正则过滤",
                        "default": "",
                        "hint": "Python 正则表达式过滤"
                    },
                    "filter_spoiler_messages": {
                        "description": "过滤遮罩/剧透消息",
                        "type": "string",
                        "options": ["继承全局", "开启", "关闭"],
                        "default": "继承全局",
                        "hint": "开启后，带有 Telegram 剧透标记（文本或媒体）的消息将被跳过"
                    },
                    "strip_markdown_links": {
                        "description": "剥离 Markdown 链接，只保留文本",
                        "type": "string",
                        "options": ["继承全局", "开启", "关闭"],
                        "default": "继承全局",
                        "hint": "开启后该频道 [文本](链接) 只保留文本"
                    },
                    "monitor_keywords": {
                        "type": "list",
                        "item_type": "string",
                        "description": "监听关键词",
                        "default": [],
                        "hint": "命中后会立即触发转发"
                    },
                    "monitor_regex": {
                        "type": "string",
                        "description": "监听正则",
                        "default": "",
                        "hint": "命中后会立即触发转发"
                    }
                }
            }
        },
        "default": [
            {
                "__template_key": "default",
                "channel_username": "heyTchuang",
                "start_time": "",
                "check_interval": 0,
                "msg_limit": 10,
                "priority": 0,
                "exclude_text_on_media": "继承全局",
                "filter_spoiler_messages": "继承全局",
                "forward_types": ["文字", "图片", "视频", "音频", "文件"],
                "max_file_size": 0,
                "monitor_keywords": [],
                "monitor_regex": ""
            }
        ],
        "hint": "添加并配置需要转发的 Telegram 频道",
        "obvious_hint": true
    },
    "forward_config": {
        "type": "object",
        "description": "全局转发配置",
        "hint": "配置全局转发配置与过滤规则",
        "items": {
            "qq_merge_threshold": {
            "description": "QQ 大合并",
            "type": "int",
            "default": 0,
            "hint": "本次要发的消息数 >= 此值时，全部打包成一条合并转发消息。设为 ≤1 则永不触发大合并。推荐 5~10"
            },
            "qq_big_merge_mode": {
                "description": "QQ 大合并的聚合范围",
                "type": "string",
                "options": ["独立频道", "混合所有频道", "关闭"],
                "default": "独立频道",
                "hint": "『独立频道』：每个频道独立判断是否合并（推荐）；『混合所有频道』：所有频道消息总数达标才合并成一条超大转发；『关闭』强制不使用大合并"
            },
            "use_channel_title": {
                "type": "bool",
                "default": true,
                "description": "显示频道标题",
                "hint": "开启时，From 头部将显示频道名称而非 ID"
            },
            "enable_deduplication": {
                "type": "bool",
                "default": true,
                "description": "转发查重",
                "hint": "开启时，如果频道 A 转发了频道 B 的消息，且频道 B 也在监控列表中，则频道 A 的这条转发消息将被自动跳过，避免重复发送"
            },
            "exclude_text_on_media": {
                "description": "媒体消息仅发送媒体",
                "type": "bool",
                "default": false,
                "hint": "如果消息包含媒体（图片、音频、视频、文件等），则不发送文本说明内容（包含标题和 From 头部）"
            },
            "filter_spoiler_messages": {
                "description": "过滤遮罩/剧透消息",
                "type": "bool",
                "default": false,
                "hint": "开启后，带有 Telegram 剧透标记（文本或媒体）的消息将被跳过"
            },
            "strip_markdown_links": {
                "description": "剥离 Markdown 链接，只保留文本",
                "type": "bool",
                "default": false,
                "hint": "开启后，[文本](链接) 只保留「文本」，链接部分被完全丢弃"
            },
            "forward_types": {
                "description": "转发消息类型",
                "type": "list",
                "hint": "选择需要搬运的消息类型，全不选表示不搬运任何消息",
                "options": ["文字", "图片", "视频", "音频", "文件"],
                "default": ["文字", "图片", "视频", "音频", "文件"]
            },
            "max_file_size": {
                "description": "文件大小限制 (MB)",
                "type": "float",
                "default": 0,
                "hint": "除图片外的媒体（音频、视频、文件）大小限制。0 表示不限制。"
            },
            "check_interval": {
                "description": "检测间隔(秒)",
                "type": "int",
                "hint": "每隔多少秒检查一次新消息",
                "default": 60
            },
            "send_interval": {
                "type": "int",
                "default": 60,
                "description": "发送执行间隔 (秒)",
                "hint": "从待发送队列中提取消息并执行转发的周期"
            },
            "batch_size_limit": {
                "description": "单次发送消息批次上限",
                "hint": "每批次发送时单次消息数量上限",
                "type": "int",
                "slider": {
                    "min": 1,
                    "max": 20,
                    "step": 1
                },
                "default": 3
            },
            "retention_period": {
                "description": "消息保留时间 (秒)",
                "hint": "超过此时间的消息在发送前将被丢弃",
                "type": "int",
                "default": 86400
            },
            "curfew_time": {
                "description": "宵禁时间段",
                "hint": "在此时间段内将跳过拉取和转发。格式如 23:00-07:00 (支持跨天)。留空禁用。",
                "type": "string",
                "default": ""
            },
            "filter_keywords": {
                "type": "list",
                "item_type": "string",
                "description": "过滤关键词",
                "default": [],
                "hint": "包含这些关键词的消息将被丢弃"
            },
            "filter_regex": {
                "type": "string",
                "description": "正则过滤",
                "default": "",
                "hint": "Python 正则表达式过滤。留空则不启用。"
            },
            "monitor_keywords": {
                "type": "list",
                "item_type": "string",
                "description": "监听关键词",
                "default": [],
                "hint": "命中后会立即触发转发"
            },
            "monitor_regex": {
                "type": "string",
                "description": "监听正则",
                "default": "",
                "hint": "命中后会立即触发转发"
            }
        }
    },
    "merge_rules": {
        "type": "template_list",
        "description": "消息合并规则（暂未实现）",
        "hint": "针对不规范频道的多消息组合进行智能合并（如预览图+原图）",
        "templates": {
            "default": {
                "name": "合并规则配置",
                "hint": "配置特定频道的消息合并规则",
                "items": {
                    "channel": {
                        "type": "string",
                        "description": "频道用户名 (不带@)",
                        "hint": "例如: SomeACG"
                    },
                    "rule_class": {
                        "type": "string",
                        "description": "规则类名",
                        "options": [
                            "",
                            "SomeACGPreviewPlusOriginal"
                        ],
                        "default": "",
                        "hint": "选择合并规则类。SomeACGPreviewPlusOriginal: 合并预览图说明+原图"
                    },
                    "params": {
                        "type": "object",
                        "description": "规则参数",
                        "items": {
                            "time_window_seconds": {
                                "type": "int",
                                "description": "时间窗口 (秒)",
                                "default": 10,
                                "hint": "关联消息的最大时间差（默认10秒）"
                            }
                        },
                        "default": {
                            "time_window_seconds": 10
                        }
                    }
                }
            }
        },
        "default": [
            {
                "__template_key": "default",
                "channel": "SomeACG",
                "rule_class": "SomeACGPreviewPlusOriginal",
                "params": {
                    "time_window_seconds": 10
                }
            }
        ],
        "obvious_hint": true
    }
}
